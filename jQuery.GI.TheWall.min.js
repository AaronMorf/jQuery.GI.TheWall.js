/*! jQuery.GI.TheWall.js v0.1.6 || Goldinteractive <mail@goldinteractive.ch> (http://goldinteractive.ch) */
!function(a,b,c,d,e,f){"use strict";f.support.transition=function(){var b=function(){var b,c=a.createElement("GI"),d={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(b in d)if(void 0!==c.style[b])return d[b]}();return b&&{end:b}}();var g=0,h=function(c,e){var h=this,i={onBeforeInit:null,onReady:null,onViewPortUpdate:null,onItemChange:null,onDestroy:null,onShow:null,onHide:null,onContentLoading:null,onContentLoaded:null,margin:{top:10,bottom:10},scrollerElm:null,scrollOffset:150,arrows:!0,closebutton:!0,keyboardNavigation:!0,animationSpeed:300,autoscroll:!0,responsive:!0,initialWrapperHeight:600,dynamicHeight:!0,nextButtonClass:"",prevButtonClass:"",closeButtonClass:""},j=("ontouchstart"in b||b.DocumentTouch&&a instanceof DocumentTouch,[33,34,35,36,37,38,39,40,27]),k=!1,l=f.support.transition,m=!1,n=0,o=".GITheWall"+g,p=f.extend(i,e);this.$el=c,this.$expanderWrapper=f('<div class="GI_TW_expander"></div>'),this.$contentPointer=f('<div class="GI_TW_pointer"></div>'),this.$expanderInner=f('<div class="GI_TW_expander-inner"></div>'),this.$list=f("> ul",this.$el).eq(0),this.$items=f("> li",this.$list),this.itemsLength=this.$items.length,this.currentIndex=null,this.currentRowIndex=null,this.$selectedli=null,this.selectedLiData=null,Function.prototype.debounce=function(a,b){var c,d,e=this;return function(){var f=this,g=arguments,h=function(){c=null,b||(d=e.apply(f,g))},i=b&&!c;return clearTimeout(c),c=setTimeout(h,a),i&&(d=e.apply(f,g)),d}};var q=function(a,b){"function"==typeof a&&f.proxy(a,h,b)()},r=function(){this.$expanderWrapper.append('<i class="GI_TW_arrow GI_TW_prev GI_TW_Controls"><span class="'+p.prevButtonClass+'"></span></i><i class="GI_TW_arrow GI_TW_next GI_TW_Controls"><span class="'+p.nextButtonClass+'"></span></i>'),this.$next=f(".GI_TW_next",this.$expanderWrapper),this.$prev=f(".GI_TW_prev",this.$expanderWrapper)},s=function(){h.$prev.toggleClass("GI_TW_hidden",h.currentIndex<=0),h.$next.toggleClass("GI_TW_hidden",h.currentIndex>=h.itemsLength-1)},t=function(a){return p.autoscroll?void f(p.scrollerElm||"html,body").animate({scrollTop:a}):!1},u=function(){h.$items.removeClass("GI_TW_Current").eq(h.currentIndex).addClass("GI_TW_Current")},v=function(){this.$contentPointer.css({left:this.selectedLiData.offset.left+this.$selectedli.width()/2})},w=function(a){var b=new f.Deferred,c=new Image;return c.onload=function(){h.$expanderInner.html('<div class="GI_TW_fullimg"><img src="'+a+'" /></div>'),b.resolve(),c=null},c.src=a,b.promise()},x=function(a){var b=new f.Deferred;return f.get(a,function(a){h.$expanderInner.html(a),b.resolve()}),b.promise()},y=function(a){this.$expanderInner.css({height:a}),a!==n&&(n=a,this.$expanderWrapper.stop(!0,!1).addClass(l?"animating":"")[l?"css":"animate"]({height:a},p.animationSpeed))},z=function(){this.selectedLiData.index<0||this.selectedLiData.index>=this.itemsLength||(this.currentIndex=this.selectedLiData.index,this.loadInnerContents(),q(p.onItemChange,this.currentIndex))},A=function(a){f.inArray(a.keyCode,j)>-1&&a.preventDefault(),39===a.keyCode?this.next():37===a.keyCode?this.prev():27===a.keyCode&&this.destroy()},B=function(a){a.stopImmediatePropagation(),a.preventDefault();var b=f(a.currentTarget);b.hasClass("GI_TW_next")?this.next():this.prev()},C=function(){q(p.onBeforeInit),p.arrows&&(r.call(this),s()),p.closebutton&&(this.$expanderWrapper.append('<div class="GI_TW_close GI_TW_Controls"><span class="'+p.closeButtonClass+'"></span></div>'),this.$closebutton=f(".GI_TW_items",this.$expanderWrapper)),this.$expanderWrapper.append(this.$contentPointer),this.$expanderWrapper.append(this.$expanderInner),this.$el.prepend(this.$expanderWrapper),this.bindAll(),q(p.onReady),g++};return this.setLisOffsets=function(){var a,b=0,c=0;this.$items.each(f.proxy(function(d,e){var g=f(e),h=g.data();g.removeClass("GI_TW_First GI_TW_Last GI_TW_Index-"+h.index+" GI_TW_Row-"+h.rowIndex);var i=!1,j=g.position(),k={top:~~j.top,left:~~j.left};(k.top>=b+3||k.top<=b-3)&&(a&&a.addClass("GI_TW_Last"),i=!0,c++),g.addClass((i?"GI_TW_First ":" ")+"GI_TW_Index-"+d+" GI_TW_Row-"+c),g.data({rowIndex:c,offset:k,index:d}),a=g,b=k.top},this))},this.setViewport=function(){k&&(this.setLisOffsets(),this.updateElementsPosition(),v.call(this),q(p.onViewPortUpdate))},this.loadInnerContents=function(){var a,b=this.$selectedli.find("a"),c=this.selectedLiData.href||b.attr("href");if(m=!0,this.$expanderInner.html('<div class="GI_TW_loading"></div>'),!c)return void console.warn("sorry.. it was not possible to load any content");switch(q(p.onContentLoading),this.selectedLiData.contenttype){case"ajax":a=x(c);break;default:a=w(c)}a.then(function(){h.$expanderInner.css({height:"auto"});var a=p.dynamicHeight?h.$expanderInner.height():p.initialWrapperHeight;y.call(h,a),h.update(),t(h.$expanderWrapper.offset().top-p.scrollOffset),q(p.onContentLoaded),m=!1})},this.showExpander=function(a){return a.preventDefault(),this.$selectedli=f(a.currentTarget),this.selectedLiData=this.$selectedli.data(),k?void z.call(this):(k=!0,this.$expanderWrapper.addClass("opened"),this.setViewport(),z.call(this),void q(p.onShow))},this.hideExpander=function(){this.$expanderWrapper.removeClass("opened").stop(!0,!1)[l?"css":"animate"]({height:0},p.animationSpeed),this.$expanderInner.empty(),this.currentRowIndex=null,this.$selectedli=null,this.selectedLiData=null,this.currentIndex=null,n=0,this.$items.removeClass("GI_TW_Selected_Row").animate({marginBottom:0},p.animationSpeed),k=!1,q(p.onHide)},this.update=function(){this.selectedLiData=this.$selectedli.data(),v.call(this),this.selectedLiData.rowIndex!==this.currentRowIndex&&this.updateElementsPosition(),p.arrows&&s(),u.call(this),this.currentRowIndex=this.selectedLiData.rowIndex},this.updateElementsPosition=function(){this.$items.each(function(a,b){var c=f(b),d=c.data(),e=d&&d.rowIndex===h.selectedLiData.rowIndex;c.toggleClass("GI_TW_Selected_Row",e).stop(!0,!1)[l?"css":"animate"]({marginBottom:e?Number(n+p.margin.bottom):0},e?p.animationSpeed:0)}),this.setLisOffsets(),this.updateExpanderPosition()},this.updateExpanderPosition=function(){if(k){var a=this.selectedLiData.offset.top+this.$selectedli.height()+p.margin.top;this.$expanderWrapper.css({top:a})}},this.resizeHeight=function(a){y.call(this,a),this.setViewport()},this.showItemByIndex=function(a){var b=this.$items.eq(a);b.length&&(this.$selectedli=b,this.selectedLiData=b.data(),z.call(this))},this.next=function(){!m&&k&&this.currentIndex!==this.itemsLength-1&&this.showItemByIndex(this.currentIndex+1)},this.prev=function(){!m&&k&&0!==this.currentIndex&&this.showItemByIndex(this.currentIndex-1)},this.bindAll=function(){l&&this.$expanderWrapper.on(l.end+o,function(){f(this).removeClass("animating")}),p.arrows&&this.$el.on("click"+o,".GI_TW_arrow",this.$expanderWrapper,f.proxy(B,this)),p.closebutton&&this.$el.on("click"+o,".GI_TW_close",this.$expanderWrapper,f.proxy(this.hideExpander,this)),this.$el.on("click"+o,"> ul > li",f.proxy(this.showExpander,this)),p.responsive&&d.on("resize"+o+" orientationchange"+o,f.proxy(this.setViewport.debounce(300),this)),p.keyboardNavigation&&d.on("keydown"+o,f.proxy(A,this))},this.unbindAll=function(){this.$el.off(o),this.$expanderWrapper.off(o)},this.destroy=function(a){a&&(a.preventDefault(),a.stopImmediatePropagation()),this.hideExpander(),this.unbindAll(),this.$expanderWrapper.remove(),q(p.onDestroy)},C.call(this),this};f.fn.GITheWall=function(a){return this.length?new h(this,a):void 0}}(document,window,$(document),$(window),$("body"),jQuery);